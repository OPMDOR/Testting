<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appointment Lookup System - Department of Refugees</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 25px 30px;
            text-align: center;
            border-bottom: 5px solid #e74c3c;
        }

        .header-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .logo-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin-bottom: 10px;
        }

        .small-logo {
            height: 60px;
            width: auto;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .header-text {
            text-align: center;
        }

        .main-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            white-space: nowrap;
        }

        .sub-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #ecf0f1;
            margin-bottom: 8px;
            white-space: nowrap;
        }

        .system-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: #e74c3c;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .instruction-text {
            font-size: 1.2rem;
            color: #ecf0f1;
            margin-top: 15px;
            line-height: 1.5;
            text-align: center;
        }

        /* Main Content */
        main {
            padding: 40px 30px;
        }

        /* Search Section */
        .search-section {
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .input-group:focus-within {
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .input-group i {
            color: #6c757d;
            font-size: 1.2rem;
        }

        .input-group input {
            flex: 1;
            border: none;
            background: none;
            font-size: 1.1rem;
            padding: 10px 0;
            outline: none;
        }

        .input-group button {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        .input-group button:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .example {
            text-align: center;
            margin-top: 10px;
        }

        .example small {
            color: #6c757d;
            font-style: italic;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #e74c3c;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            color: #6c757d;
            font-size: 1.1rem;
        }

        /* Results */
        .result {
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            animation: slideIn 0.5s ease;
            display: none;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result.success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            border: 2px solid #28a745;
            color: #155724;
        }

        .result.interviewed {
            background: linear-gradient(135deg, #cce7ff, #99ceff);
            border: 2px solid #007bff;
            color: #004085;
        }

        .result.error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            border: 2px solid #dc3545;
            color: #721c24;
        }

        .result h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-details {
            display: grid;
            gap: 12px;
            margin-top: 20px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
        }

        .detail-label {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-value {
            font-weight: 700;
            font-size: 1.1rem;
            text-align: right;
        }

        .numbered-list {
            margin-top: 15px;
            padding-left: 20px;
        }

        .numbered-list li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .document-link {
            display: inline-block;
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 12px 25px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            margin-top: 15px;
            transition: all 0.3s ease;
            text-align: center;
        }

        .document-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.4);
        }

        .status-badge {
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 10px;
        }

        /* Info Section */
        .info-section {
            margin-top: 40px;
        }

        .info-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #e74c3c;
        }

        .info-card i {
            font-size: 1.5rem;
            color: #e74c3c;
            margin-bottom: 15px;
        }

        .info-card h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .info-card p {
            color: #6c757d;
            line-height: 1.6;
        }

        .contact-info {
            margin-top: 20px;
        }

        .contact-info p {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        /* Footer */
        footer {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .location {
            font-style: italic;
            margin-top: 5px;
            opacity: 0.8;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            header {
                padding: 20px 15px;
            }
            
            .header-top {
                flex-direction: column;
                gap: 10px;
            }
            
            .small-logo {
                height: 50px;
            }
            
            .main-title {
                font-size: 1.3rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 100%;
            }
            
            .sub-title {
                font-size: 1.1rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 100%;
            }
            
            .system-title {
                font-size: 1.2rem;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 100%;
            }
            
            .instruction-text {
                font-size: 1rem;
            }
            
            .input-group {
                flex-direction: column;
                gap: 15px;
            }
            
            .input-group button {
                width: 100%;
                justify-content: center;
            }
            
            main {
                padding: 30px 20px;
            }
            
            .detail-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .detail-value {
                text-align: left;
            }
            
            .document-link {
                width: 100%;
                text-align: center;
            }
        }

        /* Extra small devices */
        @media (max-width: 480px) {
            .main-title {
                font-size: 1.1rem;
            }
            
            .sub-title {
                font-size: 1rem;
            }
            
            .system-title {
                font-size: 1rem;
            }
            
            .instruction-text {
                font-size: 0.9rem;
            }
        }

        /* Very small devices */
        @media (max-width: 360px) {
            .main-title {
                font-size: 1rem;
            }
            
            .sub-title {
                font-size: 0.9rem;
            }
            
            .system-title {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-top">
                <div class="logo-container">
                    <img src="Logos.png" alt="OPM Logo" class="small-logo" onerror="handleImageError(this)">
                </div>
                <div class="header-text">
                    <div class="main-title">OFFICE OF THE PRIME MINISTER</div>
                    <div class="sub-title">Department Of Refugees</div>
                </div>
            </div>
            <div class="system-title">Case Status & Appointments System</div>
            <p class="instruction-text">Enter your Group Number to check your interview status or schedule documentation</p>
        </header>

        <main>
            <div class="search-section">
                <div class="input-group">
                    <i class="fas fa-id-card"></i>
                    <input 
                        type="text" 
                        id="registrationId" 
                        placeholder="Enter Group Number (e.g., H9B-25-1234567)"
                        maxlength="50"
                    >
                    <button onclick="lookupAppointment()" id="searchBtn">
                        <i class="fas fa-search"></i>
                        Check Status
                    </button>
                </div>
                <div class="example">
                    <small>Example: H9B-25-1234567</small>
                </div>
            </div>

            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Searching for your case status...</p>
            </div>

            <div id="result" class="result">
                <!-- Results will be displayed here -->
            </div>

            <div class="info-section">
                <div class="info-card">
                    <i class="fas fa-exclamation-triangle" style="color: #e74c3c;"></i>
                    <h3>Important Information!</h3>
                    <p><strong>Free Services:</strong> All Interviews And Services Offered At The Department Of Refugees Are Completely Free Of Charge.</p>
                    <p><strong>No Brokers Allowed:</strong> Applicants Using Brokers Or Middlemen Will Be Immediately Disqualified.</p>
                    <div class="contact-info">
                        <p><i class="fas fa-clock"></i> Office Hours: 8:00 AM - 5:00 PM (Mon-Fri)</p>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Department of Refugees | Office of The Prime Minister</p>
            <p class="location">Sir Apollo Kagwa Road, Old Kampala</p>
            <p>&copy; 2025 Refugee Appointment System. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // Handle image loading errors
        function handleImageError(img) {
            console.log('Logo image failed to load:', img.src);
            img.style.display = 'none';
        }

        // Check if logo loads successfully
        window.addEventListener('load', function() {
            const logo = document.querySelector('.small-logo');
            if (logo && logo.complete && logo.naturalHeight === 0) {
                console.log('Logo failed to load on page load');
                handleImageError(logo);
            }
        });

        // Interview appointments data
        const appointmentData = {
            "H9B-25-6190192": "2025-11-17",
            "H9B-25-6115634": "2025-11-17",
            "H9B-25-6084816": "2025-11-17",
            "H9B-25-6082269": "2025-11-17",
            "H9B-25-6082259": "2025-11-17",
            "H9B-25-6077419": "2025-11-18",
            "H9B-25-6077351": "2025-11-18",
            "H9B-25-6074861": "2025-11-18",
            "H9B-25-6074844": "2025-11-18",
            "H9B-25-6069748": "2025-11-18",
            "H9B-25-6068162": "2025-11-18",
            "H9B-25-6067745": "2025-11-18",
            "H9B-25-6067530": "2025-11-18",
            "H9B-25-5968545": "2025-11-18",
            "H9B-25-5967796": "2025-11-18"
            // Add more registration numbers and dates from your Excel here
        };

        // People who have already completed interviews (for documentation scheduling)
        const interviewedCases = {
            "H9B-25-5000001": "2025-10-15",
            "H9B-25-5000002": "2025-10-16", 
            "H9B-25-5000003": "2025-10-17",
            "H9B-25-5000004": "2025-10-18",
            "H9B-25-5000005": "2025-10-19"
            // Add cases that have completed interviews here
        };

        // Documentation scheduling link (replace with your actual link)
        const documentationSchedulingLink = "https://forms.office.com/YourDocumentationFormLink";

        function lookupAppointment() {
            const regId = document.getElementById('registrationId').value.trim().toUpperCase();
            const resultDiv = document.getElementById('result');
            const loadingDiv = document.getElementById('loading');
            const searchBtn = document.getElementById('searchBtn');

            // Hide previous results, show loading
            resultDiv.style.display = 'none';
            loadingDiv.style.display = 'block';
            searchBtn.disabled = true;

            // Simulate API call delay
            setTimeout(() => {
                loadingDiv.style.display = 'none';
                
                if (!regId) {
                    showResult('Please enter a Group Number', 'error');
                    searchBtn.disabled = false;
                    return;
                }

                // Check if case has completed interview (for documentation)
                if (interviewedCases[regId]) {
                    const interviewDate = new Date(interviewedCases[regId]);
                    const formattedInterviewDate = interviewDate.toLocaleDateString('en-US', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });

                    showResult(`
                        <h3><i class="fas fa-check-double"></i> Interview Completed - Awaiting Decision</h3>
                        <p>Your refugee status determination interview has been completed. Your case is now under review.</p>
                        <div class="result-details">
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-id-card"></i> Group Number:</span>
                                <span class="detail-value">${regId}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-calendar-check"></i> Interview Date:</span>
                                <span class="detail-value">${formattedInterviewDate}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-tasks"></i> Current Status:</span>
                                <span class="detail-value">Interview Completed <span class="status-badge">Under Review</span></span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-file-alt"></i> Next Step:</span>
                                <span class="detail-value">Documentation & Decision</span>
                            </div>
                        </div>
                        <div style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.7); border-radius: 10px; text-align: center;">
                            <h4><i class="fas fa-calendar-plus"></i> Schedule Documentation Appointment</h4>
                            <p>Your case has been interviewed and is awaiting final decision. Please schedule your documentation appointment using the link below:</p>
                            <a href="${documentationSchedulingLink}" target="_blank" class="document-link">
                                <i class="fas fa-external-link-alt"></i> Schedule Documentation Appointment
                            </a>
                            <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                                <i class="fas fa-info-circle"></i> You will need to bring all original documents for verification.
                            </p>
                        </div>
                    `, 'interviewed');
                }
                // Check if case has upcoming interview
                else if (appointmentData[regId]) {
                    const appointmentDate = new Date(appointmentData[regId]);
                    
                    // Set fixed time to 8:00 AM
                    appointmentDate.setHours(8, 0, 0, 0);

                    const formattedDate = appointmentDate.toLocaleDateString('en-US', {
                        weekday: 'long',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });

                    showResult(`
                        <h3><i class="fas fa-check-circle"></i> Interview Appointment Confirmed!</h3>
                        <p>Your refugee status determination interview has been scheduled:</p>
                        <div class="result-details">
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-id-card"></i> Group Number:</span>
                                <span class="detail-value">${regId}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-calendar-day"></i> Interview Date:</span>
                                <span class="detail-value">${formattedDate}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-clock"></i> Time:</span>
                                <span class="detail-value">8:00 AM</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-map-marker-alt"></i> Location:</span>
                                <span class="detail-value">Department of Refugees<br>Sir Apollo Kagwa Road<br>Old Kampala</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-tasks"></i> Appointment Type:</span>
                                <span class="detail-value">Refugee Status Interview</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label"><i class="fas fa-hourglass-half"></i> Duration:</span>
                                <span class="detail-value">Approx. 1-2 hours</span>
                            </div>
                        </div>
                        <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.5); border-radius: 8px;">
                            <p><strong><i class="fas fa-info-circle"></i> Important Instructions:</strong></p>
                            <ul style="margin-top: 10px; padding-left: 20px;">
                                <li>Arrive 30 minutes before your scheduled time for security screening</li>
                                <li>Bring your original Asylum Seeker Certificate/ID and all supporting documents</li>
                                <li>Dress appropriately and look decent</li>
                                <li>No electronic devices allowed in the interview room</li>
                                <li>Late arrivals will not be allowed into the interview area</li>
                                <li>Failure to attend your appointment on the scheduled day will result in your session being rescheduled to next year</li>
                            </ul>
                        </div>
                    `, 'success');
                } else {
                    showResult(`
                        <h3><i class="fas fa-exclamation-triangle"></i> Case Not Found</h3>
                        <p>No record found for Group Number: <strong>${regId}</strong></p>
                        <div style="margin-top: 15px;">
                            <ol class="numbered-list">
                                <li>Please check that you've entered your Group Number correctly.</li>
                                <li>Your Group number is not currently in our system for interviews or completed cases.</li>
                                <li>If you believe this is an error or haven't received an appointment date, visit our office for support.</li>
                            </ol>
                        </div>
                    `, 'error');
                }
                
                searchBtn.disabled = false;
            }, 1500);
        }

        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = message;
            resultDiv.className = `result ${type}`;
            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Add event listener for Enter key
        document.getElementById('registrationId').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                lookupAppointment();
            }
        });

        // Add input validation and auto-uppercase
        document.getElementById('registrationId').addEventListener('input', function(e) {
            e.target.value = e.target.value.toUpperCase();
        });

        // Instructions for adding more data
        console.log(`To add more cases, update these objects in the JavaScript:
        
        // For upcoming interviews:
        "H9B-25-XXXXXXX": "YYYY-MM-DD",
        
        // For completed interviews (documentation scheduling):
        "H9B-25-XXXXXXX": "YYYY-MM-DD",`);
    </script>
</body>
</html>
